(function(){function l(){return !1}function h(m,f){var s,r=[];m.filterChildren(f);for(s=m.children.length-1;0<=s;s--){r.unshift(m.children[s]),m.children[s].remove()}s=m.attributes;var q=m,p=!0,o;for(o in s){if(p){p=!1}else{var k=new CKEDITOR.htmlParser.element(m.name);k.attributes[o]=s[o];q.add(k);q=k;delete s[o]}}for(s=0;s<r.length;s++){q.add(r[s])}}var d,c,n,a,b=CKEDITOR.tools,g=["o:p","xml","script","meta","link"],e="v:arc v:curve v:line v:oval v:polyline v:rect v:roundrect v:group".split(" "),i={},j=0;CKEDITOR.plugins.pastefromword={};CKEDITOR.cleanWord=function(m,f){function s(t){(t.attributes["o:gfxdata"]||"v:group"===t.parent.name)&&q.push(t.attributes.id)}var r=Boolean(m.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/)),q=[];CKEDITOR.plugins.clipboard.isCustomDataTypesSupported&&(m=CKEDITOR.plugins.pastefromword.styles.inliner.inline(m).getBody().getHtml());m=m.replace(/<!\[/g,"\x3c!--[").replace(/\]>/g,"]--\x3e");var p=CKEDITOR.htmlParser.fragment.fromHtml(m),o={root:function(t){t.filterChildren(a);CKEDITOR.plugins.pastefromword.lists.cleanup(d.createLists(t))},elementNames:[[/^\?xml:namespace$/,""],[/^v:shapetype/,""],[new RegExp(g.join("|")),""]],elements:{a:function(u){if(u.attributes.name){if("_GoBack"==u.attributes.name){delete u.name;return}if(u.attributes.name.match(/^OLE_LINK\d+$/)){delete u.name;return}}if(u.attributes.href&&u.attributes.href.match(/#.+$/)){var t=u.attributes.href.match(/#(.+)$/)[1];i[t]=u}u.attributes.name&&i[u.attributes.name]&&(u=i[u.attributes.name],u.attributes.href=u.attributes.href.replace(/.*#(.*)$/,"#$1"))},div:function(t){c.createStyleStack(t,a,f)},img:function(u){if(u.parent&&u.parent.attributes){var t=u.parent.attributes;(t=t.style||t.STYLE)&&t.match(/mso\-list:\s?Ignore/)&&(u.attributes["cke-ignored"]=!0)}c.mapStyles(u,{width:function(w){c.setStyle(u,"width",w+"px")},height:function(w){c.setStyle(u,"height",w+"px")}});u.attributes.src&&u.attributes.src.match(/^file:\/\//)&&u.attributes.alt&&u.attributes.alt.match(/^https?:\/\//)&&(u.attributes.src=u.attributes.alt);var t=u.attributes["v:shapes"]?u.attributes["v:shapes"].split(" "):[],v=CKEDITOR.tools.array.every(t,function(w){return -1<q.indexOf(w)});if(t.length&&v){return !1}},p:function(t){t.filterChildren(a);if(t.attributes.style&&t.attributes.style.match(/display:\s*none/i)){return !1}if(d.thisIsAListItem(f,t)){n.isEdgeListItem(f,t)&&n.cleanupEdgeListItem(t),d.convertToFakeListItem(f,t),b.array.reduce(t.children,function(x,w){"p"===w.name&&(0<x&&(new CKEDITOR.htmlParser.element("br")).insertBefore(w),w.replaceWithChildren(),x+=1);return x},0)}else{var v=t.getAscendant(function(w){return"ul"==w.name||"ol"==w.name}),u=b.parseCssText(t.attributes.style);v&&!v.attributes["cke-list-level"]&&u["mso-list"]&&u["mso-list"].match(/level/)&&(v.attributes["cke-list-level"]=u["mso-list"].match(/level(\d+)/)[1]);f.config.enterMode==CKEDITOR.ENTER_BR&&(delete t.name,t.add(new CKEDITOR.htmlParser.element("br")))}c.createStyleStack(t,a,f)},pre:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h1:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h2:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h3:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h4:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h5:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},h6:function(t){d.thisIsAListItem(f,t)&&d.convertToFakeListItem(f,t);c.createStyleStack(t,a,f)},font:function(t){if(t.getHtml().match(/^\s*$/)){return(new CKEDITOR.htmlParser.text(" ")).insertAfter(t),!1}f&&!0===f.config.pasteFromWordRemoveFontStyles&&t.attributes.size&&delete t.attributes.size;CKEDITOR.dtd.tr[t.parent.name]&&CKEDITOR.tools.arrayCompare(CKEDITOR.tools.objectKeys(t.attributes),["class","style"])?c.createStyleStack(t,a,f):h(t,a)},ul:function(t){if(r){return"li"==t.parent.name&&0===b.indexOf(t.parent.children,t)&&c.setStyle(t.parent,"list-style-type","none"),d.dissolveList(t),!1}},li:function(t){n.correctLevelShift(t);r&&(t.attributes.style=c.normalizedStyles(t,f),c.pushStylesLower(t))},ol:function(t){if(r){return"li"==t.parent.name&&0===b.indexOf(t.parent.children,t)&&c.setStyle(t.parent,"list-style-type","none"),d.dissolveList(t),!1}},span:function(t){t.filterChildren(a);t.attributes.style=c.normalizedStyles(t,f);if(!t.attributes.style||t.attributes.style.match(/^mso\-bookmark:OLE_LINK\d+$/)||t.getHtml().match(/^(\s|&nbsp;)+$/)){for(var u=t.children.length-1;0<=u;u--){t.children[u].insertAfter(t)}return !1}t.attributes.style.match(/FONT-FAMILY:\s*Symbol/i)&&t.forEach(function(v){v.value=v.value.replace(/&nbsp;/g,"")},CKEDITOR.NODE_TEXT,!0);c.createStyleStack(t,a,f)},table:function(u){u._tdBorders={};u.filterChildren(a);var t,w=0,v;for(v in u._tdBorders){u._tdBorders[v]>w&&(w=u._tdBorders[v],t=v)}c.setStyle(u,"border",t);w=(t=u.parent)&&t.parent;if(t.name&&"div"===t.name&&t.attributes.align&&1===b.objectKeys(t.attributes).length&&1===t.children.length){u.attributes.align=t.attributes.align;v=t.children.splice(0);u.remove();for(u=v.length-1;0<=u;u--){w.add(v[u],t.getIndex())}t.remove()}},td:function(t){var y=t.getAscendant("table"),x=y._tdBorders,w=["border","border-top","border-right","border-bottom","border-left"],y=b.parseCssText(y.attributes.style),v=y.background||y.BACKGROUND;v&&c.setStyle(t,"background",v,!0);(y=y["background-color"]||y["BACKGROUND-COLOR"])&&c.setStyle(t,"background-color",y,!0);var y=b.parseCssText(t.attributes.style),u;for(u in y){v=y[u],delete y[u],y[u.toLowerCase()]=v}for(u=0;u<w.length;u++){y[w[u]]&&(v=y[w[u]],x[v]=x[v]?x[v]+1:1)}c.createStyleStack(t,a,f,/margin|text\-align|padding|list\-style\-type|width|height|border|white\-space|vertical\-align|background/i)},"v:imagedata":l,"v:shape":function(u){var t=!1;if(null===u.getFirst("v:imagedata")){s(u)}else{u.parent.find(function(w){"img"==w.name&&w.attributes&&w.attributes["v:shapes"]==u.attributes.id&&(t=!0)},!0);if(t){return !1}var v="";"v:group"===u.parent.name?s(u):(u.forEach(function(w){w.attributes&&w.attributes.src&&(v=w.attributes.src)},CKEDITOR.NODE_ELEMENT,!0),u.filterChildren(a),u.name="img",u.attributes.src=u.attributes.src||v,delete u.attributes.type)}},style:function(){return !1},object:function(t){return !(!t.attributes||!t.attributes.data)}},attributes:{style:function(t,u){return c.normalizedStyles(u,f)||!1},"class":function(t){t=t.replace(/(el\d+)|(font\d+)|msonormal|msolistparagraph\w*/ig,"");return""===t?!1:t},cellspacing:l,cellpadding:l,border:l,"v:shapes":l,"o:spid":l},comment:function(t){t.match(/\[if.* supportFields.*\]/)&&j++;"[endif]"==t&&(j=0<j?j-1:0);return !1},text:function(u,t){if(j){return""}var v=t.parent&&t.parent.parent;return v&&v.attributes&&v.attributes.style&&v.attributes.style.match(/mso-list:\s*ignore/i)?u.replace(/&nbsp;/g," "):u}};CKEDITOR.tools.array.forEach(e,function(t){o.elements[t]=s});a=new CKEDITOR.htmlParser.filter(o);var k=new CKEDITOR.htmlParser.basicWriter;a.applyTo(p);p.writeHtml(k);return k.getHtml()};CKEDITOR.plugins.pastefromword.styles={setStyle:function(k,f,p,o){var m=b.parseCssText(k.attributes.style);o&&m[f]||(""===p?delete m[f]:m[f]=p,k.attributes.style=CKEDITOR.tools.writeCssText(m))},mapStyles:function(k,f){for(var m in f){if(k.attributes[m]){if("function"===typeof f[m]){f[m](k.attributes[m])}else{c.setStyle(k,f[m],k.attributes[m])}delete k.attributes[m]}}},normalizedStyles:function(z,y){var x="background-color:transparent border-image:none color:windowtext direction:ltr mso- text-indent visibility:visible div:border:none".split(" "),w="font-family font font-size color background-color line-height text-decoration".split(" "),v=function(){for(var q=[],k=0;k<arguments.length;k++){arguments[k]&&q.push(arguments[k])}return -1!==b.indexOf(x,q.join(":"))},u=y&&!0===y.config.pasteFromWordRemoveFontStyles,t=b.parseCssText(z.attributes.style);"cke:li"==z.name&&t["TEXT-INDENT"]&&t.MARGIN&&(z.attributes["cke-indentation"]=d.getElementIndentation(z),t.MARGIN=t.MARGIN.replace(/(([\w\.]+ ){3,3})[\d\.]+(\w+$)/,"$10$3"));for(var p=b.objectKeys(t),m=0;m<p.length;m++){var o=p[m].toLowerCase(),f=t[p[m]],s=CKEDITOR.tools.indexOf;(u&&-1!==s(w,o.toLowerCase())||v(null,o,f)||v(null,o.replace(/\-.*$/,"-"))||v(null,o)||v(z.name,o,f)||v(z.name,o.replace(/\-.*$/,"-"))||v(z.name,o)||v(f))&&delete t[p[m]]}return CKEDITOR.tools.writeCssText(t)},createStyleStack:function(m,f,s,r){var q=[];m.filterChildren(f);for(f=m.children.length-1;0<=f;f--){q.unshift(m.children[f]),m.children[f].remove()}c.sortStyles(m);f=b.parseCssText(c.normalizedStyles(m,s));s=m;var p="span"===m.name,o;for(o in f){if(!o.match(r||/margin|text\-align|width|border|padding/i)){if(p){p=!1}else{var k=new CKEDITOR.htmlParser.element("span");k.attributes.style=o+":"+f[o];s.add(k);s=k;delete f[o]}}}CKEDITOR.tools.isEmpty(f)?delete m.attributes.style:m.attributes.style=CKEDITOR.tools.writeCssText(f);for(f=0;f<q.length;f++){s.add(q[f])}},sortStyles:function(k){for(var f=["border","border-bottom","font-size","background"],r=b.parseCssText(k.attributes.style),q=b.objectKeys(r),p=[],o=[],m=0;m<q.length;m++){-1!==b.indexOf(f,q[m].toLowerCase())?p.push(q[m]):o.push(q[m])}p.sort(function(s,v){var u=b.indexOf(f,s.toLowerCase()),t=b.indexOf(f,v.toLowerCase());return u-t});q=[].concat(p,o);p={};for(m=0;m<q.length;m++){p[q[m]]=r[q[m]]}k.attributes.style=CKEDITOR.tools.writeCssText(p)},pushStylesLower:function(v,u,t){if(!v.attributes.style||0===v.children.length){return !1}u=u||{};var s={"list-style-type":!0,width:!0,height:!0,border:!0,"border-":!0},r=b.parseCssText(v.attributes.style),p;for(p in r){if(!(p.toLowerCase() in s||s[p.toLowerCase().replace(/\-.*$/,"-")]||p.toLowerCase() in u)){for(var o=!1,m=0;m<v.children.length;m++){var q=v.children[m];if(q.type===CKEDITOR.NODE_TEXT&&t){var k=new CKEDITOR.htmlParser.element("span");k.setHtml(q.value);q.replaceWith(k);q=k}q.type===CKEDITOR.NODE_ELEMENT&&(o=!0,c.setStyle(q,p,r[p]))}o&&delete r[p]}}v.attributes.style=CKEDITOR.tools.writeCssText(r);return !0},inliner:{filtered:"break-before break-after break-inside page-break page-break-before page-break-after page-break-inside".split(" "),parse:function(k){function f(t){var s=new CKEDITOR.dom.element("style"),u=new CKEDITOR.dom.element("iframe");u.hide();CKEDITOR.document.getBody().append(u);u.$.contentDocument.documentElement.appendChild(s.$);s.$.textContent=t;u.remove();return s.$.sheet}function r(t){var s=t.indexOf("{"),u=t.indexOf("}");return q(t.substring(s+1,u),!0)}var q=CKEDITOR.tools.parseCssText,p=CKEDITOR.plugins.pastefromword.styles.inliner.filter,o=k.is?k.$.sheet:f(k);k=[];var m;if(o){for(o=o.cssRules,m=0;m<o.length;m++){o[m].type===window.CSSRule.STYLE_RULE&&k.push({selector:o[m].selectorText,styles:p(r(o[m].cssText))})}}return k},filter:function(k){var f=CKEDITOR.plugins.pastefromword.styles.inliner.filtered,p=b.array.indexOf,o={},m;for(m in k){-1===p(f,m)&&(o[m]=k[m])}return o},sort:function(f){return f.sort(function(k){var m=CKEDITOR.tools.array.map(k,function(o){return o.selector});return function(p,o){var q=-1!==(""+p.selector).indexOf(".")?1:0,q=(-1!==(""+o.selector).indexOf(".")?1:0)-q;return 0!==q?q:m.indexOf(o.selector)-m.indexOf(p.selector)}}(f))},inline:function(k){var f=CKEDITOR.plugins.pastefromword.styles.inliner.parse,o=CKEDITOR.plugins.pastefromword.styles.inliner.sort,m=function(p){p=(new DOMParser).parseFromString(p,"text/html");return new CKEDITOR.dom.document(p)}(k);k=m.find("style");o=o(function(p){var r=[],q;for(q=0;q<p.count();q++){r=r.concat(f(p.getItem(q)))}return r}(k));CKEDITOR.tools.array.forEach(o,function(r){var p=r.styles;r=m.find(r.selector);var u,t,s;for(s=0;s<r.count();s++){u=r.getItem(s),t=CKEDITOR.tools.parseCssText(u.getAttribute("style")),t=CKEDITOR.tools.extend({},t,p),u.setAttribute("style",CKEDITOR.tools.writeCssText(t))}});return m}}};c=CKEDITOR.plugins.pastefromword.styles;CKEDITOR.plugins.pastefromword.lists={thisIsAListItem:function(k,f){return n.isEdgeListItem(k,f)||f.attributes.style&&f.attributes.style.match(/mso\-list:\s?l\d/)&&"li"!==f.parent.name||f.attributes["cke-dissolved"]||f.getHtml().match(/<!\-\-\[if !supportLists]\-\->/)?!0:!1},convertToFakeListItem:function(k,f){n.isDegenerateListItem(k,f)&&n.assignListLevels(k,f);this.getListItemInfo(f);if(!f.attributes["cke-dissolved"]){var o;f.forEach(function(p){!o&&"img"==p.name&&p.attributes["cke-ignored"]&&"*"==p.attributes.alt&&(o="·",p.remove())},CKEDITOR.NODE_ELEMENT);f.forEach(function(p){o||p.value.match(/^ /)||(o=p.value)},CKEDITOR.NODE_TEXT);if("undefined"==typeof o){return}f.attributes["cke-symbol"]=o.replace(/(?: |&nbsp;).*$/,"");d.removeSymbolText(f)}if(f.attributes.style){var m=b.parseCssText(f.attributes.style);m["margin-left"]&&(delete m["margin-left"],f.attributes.style=CKEDITOR.tools.writeCssText(m))}f.name="cke:li"},convertToRealListItems:function(k){var f=[];k.forEach(function(m){"cke:li"==m.name&&(m.name="li",f.push(m))},CKEDITOR.NODE_ELEMENT,!1);return f},removeSymbolText:function(k){var f,m=k.attributes["cke-symbol"];k.forEach(function(o){!f&&-1<o.value.indexOf(m)&&(o.value=o.value.replace(m,""),o.parent.getHtml().match(/^(\s|&nbsp;)*$/)&&(f=o.parent!==k?o.parent:null))},CKEDITOR.NODE_TEXT);f&&f.remove()},setListSymbol:function(k,f,q){q=q||1;var p=b.parseCssText(k.attributes.style);if("ol"==k.name){if(k.attributes.type||p["list-style-type"]){return}var o={"[ivx]":"lower-roman","[IVX]":"upper-roman","[a-z]":"lower-alpha","[A-Z]":"upper-alpha","\\d":"decimal"},m;for(m in o){if(d.getSubsectionSymbol(f).match(new RegExp(m))){p["list-style-type"]=o[m];break}}k.attributes["cke-list-style-type"]=p["list-style-type"]}else{o={"·":"disc",o:"circle","§":"square"},!p["list-style-type"]&&o[f]&&(p["list-style-type"]=o[f])}d.setListSymbol.removeRedundancies(p,q);(k.attributes.style=CKEDITOR.tools.writeCssText(p))||delete k.attributes.style},setListStart:function(k){for(var f=[],o=0,m=0;m<k.children.length;m++){f.push(k.children[m].attributes["cke-symbol"]||"")}f[0]||o++;switch(k.attributes["cke-list-style-type"]){case"lower-roman":case"upper-roman":k.attributes.start=d.toArabic(d.getSubsectionSymbol(f[o]))-o;break;case"lower-alpha":case"upper-alpha":k.attributes.start=d.getSubsectionSymbol(f[o]).replace(/\W/g,"").toLowerCase().charCodeAt(0)-96-o;break;case"decimal":k.attributes.start=parseInt(d.getSubsectionSymbol(f[o]),10)-o||1}"1"==k.attributes.start&&delete k.attributes.start;delete k.attributes["cke-list-style-type"]},numbering:{toNumber:function(k,f){function o(q){q=q.toUpperCase();for(var p=1,r=1;0<q.length;r*=26){p+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(q.charAt(q.length-1))*r,q=q.substr(0,q.length-1)}return p}function m(q){var p=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];q=q.toUpperCase();for(var w=p.length,u=0,t=0;t<w;++t){for(var v=p[t],s=v[1].length;q.substr(0,s)==v[1];q=q.substr(s)){u+=v[0]}}return u}return"decimal"==f?Number(k):"upper-roman"==f||"lower-roman"==f?m(k.toUpperCase()):"lower-alpha"==f||"upper-alpha"==f?o(k):1},getStyle:function(k){k=k.slice(0,1);var f={i:"lower-roman",v:"lower-roman",x:"lower-roman",l:"lower-roman",m:"lower-roman",I:"upper-roman",V:"upper-roman",X:"upper-roman",L:"upper-roman",M:"upper-roman"}[k];f||(f="decimal",k.match(/[a-z]/)&&(f="lower-alpha"),k.match(/[A-Z]/)&&(f="upper-alpha"));return f}},getSubsectionSymbol:function(f){return(f.match(/([\da-zA-Z]+).?$/)||["placeholder","1"])[1]},setListDir:function(k){var f=0,m=0;k.forEach(function(o){"li"==o.name&&("rtl"==(o.attributes.dir||o.attributes.DIR||"").toLowerCase()?m++:f++)},CKEDITOR.ELEMENT_NODE);m>f&&(k.attributes.dir="rtl")},createList:function(f){return(f.attributes["cke-symbol"].match(/([\da-np-zA-NP-Z]).?/)||[])[1]?new CKEDITOR.htmlParser.element("ol"):new CKEDITOR.htmlParser.element("ul")},createLists:function(z){var y,x,w,v=d.convertToRealListItems(z);if(0===v.length){return[]}var u=d.groupLists(v);for(z=0;z<u.length;z++){var t=u[z],q=t[0];for(w=0;w<t.length;w++){if(1==t[w].attributes["cke-list-level"]){q=t[w];break}}var q=[d.createList(q)],s=q[0],o=[q[0]];s.insertBefore(t[0]);for(w=0;w<t.length;w++){y=t[w];for(x=y.attributes["cke-list-level"];x>q.length;){var f=d.createList(y),p=s.children;0<p.length?p[p.length-1].add(f):(p=new CKEDITOR.htmlParser.element("li",{style:"list-style-type:none"}),p.add(f),s.add(p));q.push(f);o.push(f);s=f;x==q.length&&d.setListSymbol(f,y.attributes["cke-symbol"],x)}for(;x<q.length;){q.pop(),s=q[q.length-1],x==q.length&&d.setListSymbol(s,y.attributes["cke-symbol"],x)}y.remove();s.add(y)}q[0].children.length&&(w=q[0].children[0].attributes["cke-symbol"],!w&&1<q[0].children.length&&(w=q[0].children[1].attributes["cke-symbol"]),w&&d.setListSymbol(q[0],w));for(w=0;w<o.length;w++){d.setListStart(o[w])}for(w=0;w<t.length;w++){this.determineListItemValue(t[w])}}return v},cleanup:function(k){var f=["cke-list-level","cke-symbol","cke-list-id","cke-indentation","cke-dissolved"],o,m;for(o=0;o<k.length;o++){for(m=0;m<f.length;m++){delete k[o].attributes[f[m]]}}},determineListItemValue:function(k){if("ol"===k.parent.name){var f=this.calculateValue(k),o=k.attributes["cke-symbol"].match(/[a-z0-9]+/gi),m;o&&(o=o[o.length-1],m=k.parent.attributes["cke-list-style-type"]||this.numbering.getStyle(o),o=this.numbering.toNumber(o,m),o!==f&&(k.attributes.value=o))}},calculateValue:function(k){if(!k.parent){return 1}var f=k.parent;k=k.getIndex();var q=null,p,o,m;for(m=k;0<=m&&null===q;m--){o=f.children[m],o.attributes&&void 0!==o.attributes.value&&(p=m,q=parseInt(o.attributes.value,10))}null===q&&(q=void 0!==f.attributes.start?parseInt(f.attributes.start,10):1,p=0);return q+(k-p)},dissolveList:function(w){function v(f){return 50<=f?"l"+v(f-50):40<=f?"xl"+v(f-40):10<=f?"x"+v(f-10):9==f?"ix":5<=f?"v"+v(f-5):4==f?"iv":1<=f?"i"+v(f-1):""}function u(q,f){function x(y,z){return y&&y.parent?q(y.parent)?x(y.parent,z+1):x(y.parent,z):z}return x(f,0)}var t=function(f){return function(q){return q.name==f}},s=function(f){return t("ul")(f)||t("ol")(f)},p=CKEDITOR.tools.array,o=[],r,k;w.forEach(function(f){o.push(f)},CKEDITOR.NODE_ELEMENT,!1);r=p.filter(o,t("li"));var m=p.filter(o,s);p.forEach(m,function(x){var y=x.attributes.type,z=parseInt(x.attributes.start,10)||1,q=u(s,x)+1;y||(y=b.parseCssText(x.attributes.style)["list-style-type"]);p.forEach(p.filter(x.children,t("li")),function(B,A){var f;switch(y){case"disc":f="·";break;case"circle":f="o";break;case"square":f="§";break;case"1":case"decimal":f=z+A+".";break;case"a":case"lower-alpha":f=String.fromCharCode(97+z-1+A)+".";break;case"A":case"upper-alpha":f=String.fromCharCode(65+z-1+A)+".";break;case"i":case"lower-roman":f=v(z+A)+".";break;case"I":case"upper-roman":f=v(z+A).toUpperCase()+".";break;default:f="ul"==x.name?"·":z+A+"."}B.attributes["cke-symbol"]=f;B.attributes["cke-list-level"]=q})});r=p.reduce(r,function(q,f){var y=f.children[0];if(y&&y.name&&y.attributes.style&&y.attributes.style.match(/mso-list:/i)){c.pushStylesLower(f,{"list-style-type":!0,display:!0});var x=b.parseCssText(y.attributes.style,!0);c.setStyle(f,"mso-list",x["mso-list"],!0);c.setStyle(y,"mso-list","");delete f["cke-list-level"];(y=x.display?"display":x.DISPLAY?"DISPLAY":"")&&c.setStyle(f,"display",x[y],!0)}if(1===f.children.length&&s(f.children[0])){return q}f.name="p";f.attributes["cke-dissolved"]=!0;q.push(f);return q},[]);for(k=r.length-1;0<=k;k--){r[k].insertAfter(w)}for(k=m.length-1;0<=k;k--){delete m[k].name}},groupLists:function(k){var f,q,p=[[k[0]]],o=p[0];q=k[0];q.attributes["cke-indentation"]=q.attributes["cke-indentation"]||d.getElementIndentation(q);for(f=1;f<k.length;f++){q=k[f];var m=k[f-1];q.attributes["cke-indentation"]=q.attributes["cke-indentation"]||d.getElementIndentation(q);q.previous!==m&&(d.chopDiscontinuousLists(o,p),p.push(o=[]));o.push(q)}d.chopDiscontinuousLists(o,p);return p},chopDiscontinuousLists:function(v,u){for(var t={},s=[[]],r,q=0;q<v.length;q++){var p=t[v[q].attributes["cke-list-level"]],m=this.getListItemInfo(v[q]),o,f;p?(f=p.type.match(/alpha/)&&7==p.index?"alpha":f,f="o"==v[q].attributes["cke-symbol"]&&14==p.index?"alpha":f,o=d.getSymbolInfo(v[q].attributes["cke-symbol"],f),m=this.getListItemInfo(v[q]),(p.type!=o.type||r&&m.id!=r.id&&!this.isAListContinuation(v[q]))&&s.push([])):o=d.getSymbolInfo(v[q].attributes["cke-symbol"]);for(r=parseInt(v[q].attributes["cke-list-level"],10)+1;20>r;r++){t[r]&&delete t[r]}t[v[q].attributes["cke-list-level"]]=o;s[s.length-1].push(v[q]);r=m}[].splice.apply(u,[].concat([b.indexOf(u,v),1],s))},isAListContinuation:function(k){var f=k;do{if((f=f.previous)&&f.type===CKEDITOR.NODE_ELEMENT){if(void 0===f.attributes["cke-list-level"]){break}if(f.attributes["cke-list-level"]===k.attributes["cke-list-level"]){return f.attributes["cke-list-id"]===k.attributes["cke-list-id"]}}}while(f);return !1},getElementIndentation:function(k){k=b.parseCssText(k.attributes.style);if(k.margin||k.MARGIN){k.margin=k.margin||k.MARGIN;var f={styles:{margin:k.margin}};CKEDITOR.filter.transformationsTools.splitMarginShorthand(f);k["margin-left"]=f.styles["margin-left"]}return parseInt(b.convertToPx(k["margin-left"]||"0px"),10)},toArabic:function(f){return f.match(/[ivxl]/i)?f.match(/^l/i)?50+d.toArabic(f.slice(1)):f.match(/^lx/i)?40+d.toArabic(f.slice(1)):f.match(/^x/i)?10+d.toArabic(f.slice(1)):f.match(/^ix/i)?9+d.toArabic(f.slice(2)):f.match(/^v/i)?5+d.toArabic(f.slice(1)):f.match(/^iv/i)?4+d.toArabic(f.slice(2)):f.match(/^i/i)?1+d.toArabic(f.slice(1)):d.toArabic(f.slice(1)):0},getSymbolInfo:function(k,f){var o=k.toUpperCase()==k?"upper-":"lower-",m={"·":["disc",-1],o:["circle",-2],"§":["square",-3]};if(k in m||f&&f.match(/(disc|circle|square)/)){return{index:m[k][1],type:m[k][0]}}if(k.match(/\d/)){return{index:k?parseInt(d.getSubsectionSymbol(k),10):0,type:"decimal"}}k=k.replace(/\W/g,"").toLowerCase();return !f&&k.match(/[ivxl]+/i)||f&&"alpha"!=f||"roman"==f?{index:d.toArabic(k),type:o+"roman"}:k.match(/[a-z]/i)?{index:k.charCodeAt(0)-97,type:o+"alpha"}:{index:-1,type:"disc"}},getListItemInfo:function(k){if(void 0!==k.attributes["cke-list-id"]){return{id:k.attributes["cke-list-id"],level:k.attributes["cke-list-level"]}}var f=b.parseCssText(k.attributes.style)["mso-list"],m={id:"0",level:"1"};f&&(f+=" ",m.level=f.match(/level(.+?)\s+/)[1],m.id=f.match(/l(\d+?)\s+/)[1]);k.attributes["cke-list-level"]=void 0!==k.attributes["cke-list-level"]?k.attributes["cke-list-level"]:m.level;k.attributes["cke-list-id"]=m.id;return m}};d=CKEDITOR.plugins.pastefromword.lists;CKEDITOR.plugins.pastefromword.images={extractFromRtf:function(k){var f=[],p=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,o;k=k.match(new RegExp("(?:("+p.source+"))([\\da-fA-F\\s]+)\\}","g"));if(!k){return f}for(var m=0;m<k.length;m++){if(p.test(k[m])){if(-1!==k[m].indexOf("\\pngblip")){o="image/png"}else{if(-1!==k[m].indexOf("\\jpegblip")){o="image/jpeg"}else{continue}}f.push({hex:o?k[m].replace(p,"").replace(/[^\da-fA-F]/g,""):null,type:o})}}return f},extractTagsFromHtml:function(k){for(var f=/<img[^>]+src="([^"]+)[^>]+/g,o=[],m;m=f.exec(k);){o.push(m[1])}return o}};CKEDITOR.plugins.pastefromword.heuristics={isEdgeListItem:function(k,f){if(!CKEDITOR.env.edge||!k.config.pasteFromWord_heuristicsEdgeList){return !1}var m="";f.forEach&&f.forEach(function(o){m+=o.value},CKEDITOR.NODE_TEXT);return m.match(/^(?: |&nbsp;)*\(?[a-zA-Z0-9]+?[\.\)](?: |&nbsp;){2,}/)?!0:n.isDegenerateListItem(k,f)},cleanupEdgeListItem:function(k){var f=!1;k.forEach(function(m){f||(m.value=m.value.replace(/^(?:&nbsp;|[\s])+/,""),m.value.length&&(f=!0))},CKEDITOR.NODE_TEXT)},isDegenerateListItem:function(k,f){return !!f.attributes["cke-list-level"]||f.attributes.style&&!f.attributes.style.match(/mso\-list/)&&!!f.find(function(m){if(m.type==CKEDITOR.NODE_ELEMENT&&f.name.match(/h\d/i)&&m.getHtml().match(/^[a-zA-Z0-9]+?[\.\)]$/)){return !0}var p=b.parseCssText(m.attributes&&m.attributes.style,!0);if(!p){return !1}var o=p["font-family"]||"";return(p.font||p["font-size"]||"").match(/7pt/i)&&!!m.previous||o.match(/symbol/i)},!0).length},assignListLevels:function(v,u){if(!u.attributes||void 0===u.attributes["cke-list-level"]){for(var t=[d.getElementIndentation(u)],s=[u],r=[],q=CKEDITOR.tools.array,p=q.map;u.next&&u.next.attributes&&!u.next.attributes["cke-list-level"]&&n.isDegenerateListItem(v,u.next);){u=u.next,t.push(d.getElementIndentation(u)),s.push(u)}var o=p(t,function(m,k){return 0===k?0:m-t[k-1]}),f=this.guessIndentationStep(q.filter(t,function(k){return 0!==k})),r=p(t,function(k){return Math.round(k/f)});-1!==q.indexOf(r,0)&&(r=p(r,function(k){return k+1}));q.forEach(s,function(m,k){m.attributes["cke-list-level"]=r[k]});return{indents:t,levels:r,diffs:o}}},guessIndentationStep:function(f){return f.length?Math.min.apply(null,f):null},correctLevelShift:function(k){if(this.isShifted(k)){var f=CKEDITOR.tools.array.filter(k.children,function(o){return"ul"==o.name||"ol"==o.name}),m=CKEDITOR.tools.array.reduce(f,function(p,o){return(o.children&&1==o.children.length&&n.isShifted(o.children[0])?[o]:o.children).concat(p)},[]);CKEDITOR.tools.array.forEach(f,function(o){o.remove()});CKEDITOR.tools.array.forEach(m,function(o){k.add(o)});delete k.name}},isShifted:function(f){return"li"!==f.name?!1:0===CKEDITOR.tools.array.filter(f.children,function(k){return k.name&&("ul"==k.name||"ol"==k.name||"p"==k.name&&0===k.children.length)?!1:!0}).length}};n=CKEDITOR.plugins.pastefromword.heuristics;d.setListSymbol.removeRedundancies=function(k,f){(1===f&&"disc"===k["list-style-type"]||"decimal"===k["list-style-type"])&&delete k["list-style-type"]};CKEDITOR.plugins.pastefromword.createAttributeStack=h;CKEDITOR.config.pasteFromWord_heuristicsEdgeList=!0})();